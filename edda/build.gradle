
import zerotocloud.*
task cloneRepo(type: CloneRepo) {
    repository = 'https://github.com/Netflix/edda.git'
}

task buildRepo(type: Build) {
    dependsOn 'cloneRepo'
    moduleDir = cloneRepo.gitDir
    arguments = ['build', '-x', 'check', '-x', 'scaladocJar', '-x', 'sourcesJar', '-x', 'javadocJar', '--stacktrace']
}

// TODO /var/lib/tomcat7/webapps/edda/WEB-INF/classes/edda.properties with region
ospackage {
    depends('mongodb')
    from(buildRepo) {
        into('/var/lib/tomcat7/webapps/')
        include '*.war'
        rename(/.*/, 'ROOT.war')
    }
}
